
training of backgammon
(1, 34)
-1.7976931348623157e+308
0.0061728396
-1.7976931348623157e+308
0.0061728396
-1.7976931348623157e+308
0.0061728396
-1.7976931348623157e+308
0.0061728396
-1.7976931348623157e+308
0.0061728396
-1.7976931348623157e+308
0.0061728396
-1.7976931348623157e+308
0.0061728396
-1.7976931348623157e+308
0.0061728396
-1.7976931348623157e+308
0.0061728396
-1.7976931348623157e+308
0.0061728396
-1.7976931348623157e+308
0.0061728396
-1.7976931348623157e+308
0.0061728396
Traceback (most recent call last):
  File "/root/src/pgx/pgx/workspace/backgammon_trainig/ppo.py", line 356, in <module>
    out = train(config, rng)
  File "/root/src/pgx/pgx/workspace/backgammon_trainig/ppo.py", line 319, in train
    eval_R = evaluate(runner_state[0], old_train_state, network, env, rng, 10)
  File "/root/src/pgx/pgx/workspace/backgammon_trainig/ppo.py", line 253, in evaluate
    logits, value = network.apply(new_state.params, state.observation)
  File "/root/.pyenv/versions/3.10.0/lib/python3.10/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/root/.pyenv/versions/3.10.0/lib/python3.10/site-packages/flax/linen/module.py", line 1489, in apply
    return apply(
  File "/root/.pyenv/versions/3.10.0/lib/python3.10/site-packages/flax/core/scope.py", line 933, in wrapper
    y = fn(root, *args, **kwargs)
  File "/root/.pyenv/versions/3.10.0/lib/python3.10/site-packages/flax/linen/module.py", line 2060, in scope_fn
    return fn(module.clone(parent=scope), *args, **kwargs)
  File "/root/.pyenv/versions/3.10.0/lib/python3.10/site-packages/flax/linen/module.py", line 432, in wrapped_module_method
    return self._call_wrapped_method(fun, args, kwargs)
  File "/root/.pyenv/versions/3.10.0/lib/python3.10/site-packages/flax/linen/module.py", line 864, in _call_wrapped_method
    y = fun(self, *args, **kwargs)
  File "/root/src/pgx/pgx/workspace/backgammon_trainig/ppo.py", line 64, in __call__
    critic = nn.Dense(
  File "/root/.pyenv/versions/3.10.0/lib/python3.10/site-packages/flax/linen/module.py", line 432, in wrapped_module_method
    return self._call_wrapped_method(fun, args, kwargs)
  File "/root/.pyenv/versions/3.10.0/lib/python3.10/site-packages/flax/linen/module.py", line 864, in _call_wrapped_method
    y = fun(self, *args, **kwargs)
  File "/root/.pyenv/versions/3.10.0/lib/python3.10/site-packages/flax/linen/linear.py", line 196, in __call__
    kernel = self.param('kernel',
  File "/root/.pyenv/versions/3.10.0/lib/python3.10/site-packages/flax/linen/module.py", line 1241, in param
    v = self.scope.param(name, init_fn, *init_args, unbox=unbox)
  File "/root/.pyenv/versions/3.10.0/lib/python3.10/site-packages/flax/core/scope.py", line 827, in param
    abs_value = jax.eval_shape(lambda rng: init_fn(rng, *init_args), abs_rng)
  File "/root/.pyenv/versions/3.10.0/lib/python3.10/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/root/.pyenv/versions/3.10.0/lib/python3.10/site-packages/jax/_src/api.py", line 2751, in eval_shape
    out = pe.abstract_eval_fun(wrapped_fun.call_wrapped,
  File "/root/.pyenv/versions/3.10.0/lib/python3.10/site-packages/jax/_src/interpreters/partial_eval.py", line 670, in abstract_eval_fun
    _, avals_out, _ = trace_to_jaxpr_dynamic(
  File "/root/.pyenv/versions/3.10.0/lib/python3.10/site-packages/jax/_src/profiler.py", line 314, in wrapper
    return func(*args, **kwargs)
  File "/root/.pyenv/versions/3.10.0/lib/python3.10/site-packages/jax/_src/interpreters/partial_eval.py", line 2150, in trace_to_jaxpr_dynamic
    jaxpr, out_avals, consts = trace_to_subjaxpr_dynamic(
  File "/root/.pyenv/versions/3.10.0/lib/python3.10/site-packages/jax/_src/interpreters/partial_eval.py", line 2172, in trace_to_subjaxpr_dynamic
    ans = fun.call_wrapped(*in_tracers_)
  File "/root/.pyenv/versions/3.10.0/lib/python3.10/site-packages/jax/_src/linear_util.py", line 188, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
  File "/root/.pyenv/versions/3.10.0/lib/python3.10/site-packages/jax/_src/linear_util.py", line 188, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
  File "/root/.pyenv/versions/3.10.0/lib/python3.10/site-packages/flax/core/scope.py", line 827, in <lambda>
    abs_value = jax.eval_shape(lambda rng: init_fn(rng, *init_args), abs_rng)
  File "/root/.pyenv/versions/3.10.0/lib/python3.10/site-packages/jax/_src/nn/initializers.py", line 570, in init
    Q *= diag_sign # needed for a uniform distribution
  File "/root/.pyenv/versions/3.10.0/lib/python3.10/site-packages/jax/_src/numpy/array_methods.py", line 790, in op
    return getattr(self.aval, f"_{name}")(self, *args)
  File "/root/.pyenv/versions/3.10.0/lib/python3.10/site-packages/jax/_src/numpy/array_methods.py", line 258, in deferring_binary_op
    return binary_op(*args)
  File "/root/.pyenv/versions/3.10.0/lib/python3.10/site-packages/jax/_src/traceback_util.py", line 166, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/root/.pyenv/versions/3.10.0/lib/python3.10/site-packages/jax/_src/pjit.py", line 208, in cache_miss
    outs, out_flat, out_tree, args_flat = _python_pjit_helper(
  File "/root/.pyenv/versions/3.10.0/lib/python3.10/site-packages/jax/_src/pjit.py", line 150, in _python_pjit_helper
    args_flat, _, params, in_tree, out_tree, _ = infer_params_fn(
  File "/root/.pyenv/versions/3.10.0/lib/python3.10/site-packages/jax/_src/api.py", line 301, in infer_params
    return pjit.common_infer_params(pjit_info_args, *args, **kwargs)
  File "/root/.pyenv/versions/3.10.0/lib/python3.10/site-packages/jax/_src/pjit.py", line 408, in common_infer_params
    dbg = debug_info(jit_name, fun, args, kwargs, static_argnums, static_argnames)
  File "/root/.pyenv/versions/3.10.0/lib/python3.10/site-packages/jax/_src/api_util.py", line 599, in debug_info
    arg_names = _arg_names(fun, args, kwargs, static_argnums, static_argnames)
  File "/root/.pyenv/versions/3.10.0/lib/python3.10/site-packages/jax/_src/api_util.py", line 623, in _arg_names
    ba = inspect.signature(fn).bind(*args_, **kwargs)
  File "/root/.pyenv/versions/3.10.0/lib/python3.10/inspect.py", line 3245, in signature
    return Signature.from_callable(obj, follow_wrapped=follow_wrapped,
  File "/root/.pyenv/versions/3.10.0/lib/python3.10/inspect.py", line 2993, in from_callable
    return _signature_from_callable(obj, sigcls=cls,
  File "/root/.pyenv/versions/3.10.0/lib/python3.10/inspect.py", line 2454, in _signature_from_callable
    return _signature_from_function(sigcls, obj,
  File "/root/.pyenv/versions/3.10.0/lib/python3.10/inspect.py", line 2319, in _signature_from_function
    parameters.append(Parameter(name, annotation=annotation,
  File "/root/.pyenv/versions/3.10.0/lib/python3.10/inspect.py", line 2630, in __init__
    self._kind = _ParameterKind(kind)
  File "/root/.pyenv/versions/3.10.0/lib/python3.10/enum.py", line 358, in __call__
    def __call__(cls, value, names=None, *, module=None, qualname=None, type=None, start=1):
KeyboardInterrupt
-1.7976931348623157e+308
0.0061728396
-1.7976931348623157e+308
0.0061728396
-1.7976931348623157e+308
0.0061728396
-1.7976931348623157e+308
0.0061728396